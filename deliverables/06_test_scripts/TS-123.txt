TEST SCRIPT: TS-123
Test Scenario: Handle Out of Stock Items
User Story: As a System, I want to prevent purchase of unavailable products, so that I can avoid disappointing customers
Priority: High
Related Requirements: FR-019

GIVEN products exist in the catalog with various stock levels
  AND stock inventory is tracked in the system

WHEN a product's stock quantity reaches zero

THEN the system should:
  - Mark product as "Out of Stock"
  - Display "Out of Stock" status on product page
  - Disable "Add to Cart" button
  - Optionally show "Notify when available" option

WHEN a customer tries to add out of stock item to cart

THEN the system should:
  - Prevent adding to cart
  - Display message "This item is currently out of stock"
  - Suggest similar available products (optional)

WHEN an item in customer's cart goes out of stock

THEN the system should:
  - Mark item as unavailable in cart
  - Prevent checkout with unavailable items
  - Notify customer in cart view
  - Provide option to remove item or save for later

WHEN customer attempts to checkout with out of stock items

THEN the system should:
  - Block checkout process
  - Display error message listing unavailable items
  - Require removal of out of stock items
  - Allow checkout only after cart contains available items only

WHEN stock level is low but not zero

THEN the system should:
  - Display remaining quantity (e.g., "Only 3 left")
  - Limit quantity customer can add to remaining stock
  - Update availability in real-time

WHEN multiple customers try to purchase the last item(s)

THEN the system should:
  - Use inventory locking during checkout
  - Prevent overselling
  - First to complete payment gets the item
  - Show accurate availability to all users

WHEN product is restocked

THEN the system should:
  - Update stock status to available
  - Re-enable "Add to Cart" button
  - Notify customers who requested notification (if applicable)

EXPECTED RESULT:
- Out of stock items cannot be purchased
- Stock status is displayed accurately
- Customers are prevented from adding unavailable items
- Checkout is blocked if cart contains unavailable items
- Real-time stock updates prevent overselling
- Low stock warnings help customers
- Inventory locking prevents race conditions
- Restock updates availability immediately
- Customer experience manages expectations clearly
