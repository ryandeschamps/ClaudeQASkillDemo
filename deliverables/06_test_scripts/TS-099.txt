TEST SCRIPT: TS-099
Test Scenario: Export Report as Excel
User Story: As a Logged-in Admin, I want to export reports in Excel format, so that I can perform further analysis
Priority: Medium
Related Requirements: FR-021

GIVEN the admin is logged into the admin panel
  AND a report has been generated (revenue, products, or other report)
  AND the admin is viewing the report results

WHEN the admin clicks "Export as Excel" or "Download Excel" button

THEN the system should:
  - Generate an Excel (.xlsx or .xls) version of the report
  - Include all report data in spreadsheet format
  - Format the Excel file with:
    * Report title in first row
    * Column headers
    * Data rows
    * Summary/totals row at bottom
    * Proper data types (numbers as numbers, dates as dates)
    * Auto-fitted column widths
  - Trigger download of the Excel file

WHEN the Excel file is generated

THEN the file should:
  - Have a meaningful filename (e.g., "Revenue_Report_Jan2025.xlsx")
  - Be properly formatted for Excel/spreadsheet applications
  - Include all data from the report
  - Preserve numerical data types for calculations
  - Be compatible with Microsoft Excel and similar applications

WHEN the report has multiple data sections

THEN the Excel file should:
  - Include all sections
  - Optionally use multiple worksheets/sheets
  - Include formulas for totals (if applicable)
  - Format headers distinctly (bold, background color)

WHEN the download completes

THEN the admin should be able to:
  - Open the file in Excel or similar application
  - Perform calculations and analysis
  - Create pivot tables and charts
  - Filter and sort data
  - Modify and save the file

EXPECTED RESULT:
- Excel export functionality works correctly
- Generated Excel file is properly formatted
- All report data is included and accurate
- Data types are preserved (numbers, dates)
- File is downloadable and usable in Excel
- Admin can perform additional analysis on exported data
- Compatible with common spreadsheet applications
- Works for all report types
